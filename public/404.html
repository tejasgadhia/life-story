<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Story - Your Personal Historical Report</title>
    <link rel="icon" type="image/svg+xml" href="/life-story/favicon.svg">

    <!-- Meta Description -->
    <meta name="description" content="Discover your personalized historical report. Enter your birth date to explore your generation's defining moments, cultural touchstones, and historical context.">
    <meta name="author" content="Tejas Gadhia">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tejasgadhia.github.io/life-story/">
    <meta property="og:title" content="Life Story - Your Personal Historical Report">
    <meta property="og:description" content="Discover your personalized historical report based on your birth date.">
    <meta property="og:image" content="https://tejasgadhia.github.io/life-story/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Life Story - Your Personal Historical Report">
    <meta name="twitter:description" content="Discover your personalized historical report based on your birth date.">
    <meta name="twitter:image" content="https://tejasgadhia.github.io/life-story/og-image.png">

    <!-- PWA -->
    <meta name="theme-color" content="#292524">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Life Story">
    <link rel="apple-touch-icon" sizes="180x180" href="/life-story/apple-touch-icon.png">
    <link rel="manifest" href="/life-story/manifest.json">

    <!-- Canonical -->
    <link rel="canonical" href="https://tejasgadhia.github.io/life-story/">

    <!--
      GitHub Pages SPA Redirect (Step 1 of 2)
      =========================================
      WHY THIS EXISTS:
      GitHub Pages only serves static files. Any path that doesn't map to a real
      file (e.g. /life-story/1988-06-09/timeline) returns a 404. GitHub Pages
      lets you customize the 404 page, so we use it as a trampoline to bounce
      users back to index.html where React Router can handle the route.

      HOW IT WORKS:
      1. This 404.html saves the original path+search+hash to sessionStorage
      2. Redirects to the app root (/life-story/) — a clean URL, no query params
      3. index.html (Step 2) reads sessionStorage and calls history.replaceState
         to restore the original URL before React mounts

      WHY sessionStorage INSTEAD OF query params:
      - The URL bar stays clean during the redirect (no /?/path/here flash)
      - No need for ~and~ encoding of & characters in the URL
      - sessionStorage is cleared automatically when the tab closes
      - Survives the single redirect hop but nothing more

      FALLBACK:
      If sessionStorage is unavailable (private browsing in some browsers, or
      storage disabled), falls back to the original query-param method so the
      redirect still works.

      UNAVOIDABLE LIMITATIONS (GitHub Pages constraint):
      - The 404 HTTP status still appears in DevTools Network tab. There is no
        way to serve a 200 for unknown paths without a real server. This is
        cosmetic only and does not affect functionality.
      - There is still one redirect hop (404.html -> index.html). This adds
        roughly 50-100ms. The only way to eliminate it is server-side routing
        (Netlify _redirects, Vercel rewrites, etc).
      - If both sessionStorage AND JavaScript are disabled, the user sees a
        blank page. This is acceptable for an SPA.
    -->
    <script type="text/javascript">
      (function() {
        var loc = window.location;
        try {
          // Primary method: save path in sessionStorage for a clean redirect URL
          sessionStorage.setItem('spa-redirect', JSON.stringify({
            pathname: loc.pathname,
            search: loc.search,
            hash: loc.hash
          }));
          // Redirect to app root — index.html will restore the original path
          loc.replace(
            loc.protocol + '//' + loc.hostname + (loc.port ? ':' + loc.port : '') +
            '/life-story/'
          );
        } catch (e) {
          // Fallback: encode path as query param (original spa-github-pages method)
          // This handles cases where sessionStorage is unavailable
          var pathSegmentsToKeep = 1;
          loc.replace(
            loc.protocol + '//' + loc.hostname + (loc.port ? ':' + loc.port : '') +
            loc.pathname.split('/').slice(0, 1 + pathSegmentsToKeep).join('/') + '/?/' +
            loc.pathname.slice(1).split('/').slice(pathSegmentsToKeep).join('/').replace(/&/g, '~and~') +
            (loc.search ? '&' + loc.search.slice(1).replace(/&/g, '~and~') : '') +
            loc.hash
          );
        }
      })();
    </script>
  </head>
  <body>
  </body>
</html>
